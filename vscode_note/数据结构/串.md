# <center> 串 <center/> 

## 1. 串的模式匹配

1. 主串和模式串：模式串指待匹配的串。模式匹配就是求子串在主串中的位置。

2. 简单匹配算法：
3. kmp算法：
   1. 前缀、后缀和部分匹配值：
      - 前缀：除最后一个字符外，字符串所有的头部字串。

      - 后缀：除第一个字符外，字符串的所有尾部子串。
      - 部分匹配值：字符串的前缀和后缀的最长相等前后缀长度。
      ```
      比如：有串'ababa'

      'a' 的前缀和后缀都是空集，最长相等前后缀长度为0。
      'ab' 的前缀为 {a}，后缀为 {b}，{a}、{b}交集为空，故最长相等前后缀长度为0。
      'aba' 的前缀为 {a,ab}，后缀为 {b,ba}，{a,ab}、{b,ba}交集为{a}，故最长相等前后缀长度为1。
      'abab' 的前缀为 {a,ab,aba}，后缀为 {b,ab,bab}，最长相等前后缀长度为2。
      'ababa' 的前缀为 {a,ab,aba,abab}，后缀为 {b,ab,bab,baba}，最长相等前后缀为3。

      所以，串'ababa'的部分匹配值为00123。
      ```

   2. 向后移动位数：**移动位数 = 已匹配的字符数 - 对应的部分匹配值**。
      ```
      比如：有主串'ababcabcacbab'，模式串'abcac'，部分匹配值'00010'

      第一轮：
      a  b  a  b  c  a  b  c  a  c  b  a  b
      a  b  c

      c、a不匹配，已匹配2个字符，最后一个匹配字符b的部分匹配值为0，所以移动2 - 0 = 2位。

      第二轮：
      a  b  a  b  c  a  b  c  a  c  b  a  b
            a  b  c  a  c

      c、b不匹配，已匹配4个字符，最后一个匹配字符a的部分匹配值为1，所以移动4 - 1 = 3位。

      第三轮：
      a  b  a  b  c  a  b  c  a  c  b  a  b
                     a  b  c  a  c

      成功。
      ```
   3. next数组：
      - 数组下标从0开始：将部分匹配值PM整体右移一位，空出的地方补上-1即可。

      - 数组下标从1开始：再将next数组整体加1即可。
      ```
      发生失配时，主串指针不变，子串指针变化公式为： j = next[j]。
      ```
   4. nextval数组（即白书里面的next数组）：
      - 第一个元素为0，即`nextval[1] = 0`。
         ```
         如果数组从0开始，nextval[0] = -1。
         ```

      - 若 `T[i] != T[next[i]]`，则 `nextval[i] = next[i]`。
      - 若 `T[i] == T[next[i]]`，则 `nextval[i] = nextval[nextval[i]]`。

      ```
      比如：模式串'ababaaaba'

         j     1  2  3  4  5  6  7  8  9  
         t     a  b  a  b  a  a  a  b  a
      next     0  1  1  2  3  4  2  2  3  
      nextval  0  1  0  1  0  4  2  1  0

      T[1] = 0;
      T[2] = b, T[next[2]] = T[1] = a, T[2] != T[next[2]], nextval[2] = next[2] = 1;
      T[3] = a, T[next[3]] = T[1] = a, T[3] == T[next[3]],nextval[3] = nextval[next[3]] = nextval[1] = 0; 
      ```